options {

    directory 	"/var/cache/bind";        // Store  zone cache file

	listen-on port 53 { 172.16.20.10; };  // isten on a specific IP 

	recursion yes;                        // Enable recursive queries for local clients
	allow-query     { any; };             // Allow queries from any client
    allow-transfer { any; };              // Allow transfer to a slave DNS

     forwarders {
        1.1.1.1;                           // Example: Cloudflare
        8.8.8.8;                           // Example: Google
    };
 
	dnssec-validation auto;
};

logging {
  
   channel query_syslog {                 // Define a channel for query logs to syslog
        syslog local4;
        severity debug;
        print-time yes;
        print-severity yes;
    };
   
    category queries { query_syslog; };
};


                                           // ZONE TRANSFER WITH TSIG
include "/etc/bind/named.zonetransfer.key"; 
server 172.16.20.11 {
    keys { "zonetransfer.key"; };
};

                                           // root zone
zone "." IN {
	type hint;
	file "/etc/bind/db.0";
};

                                          // zones like localhost
include "/etc/bind/zones.rfc1918";
// root's DNSKEY
//include "/etc/named.root.key";

// lab's zone
zone "dns.lab" {
    type master;
    allow-transfer { key "zonetransfer.key"; };
    file "/etc/bind/named.dns.lab";
};

zone "dnsnew.lab" {
     type master;
     allow-transfer { key "zonetransfer.key"; };
     allow-update { key "zonetransfer.key"; };
     file "/etc/bind/named.dnsnew.lab";
};

// lab's zone reverse
zone "20.16.172.in-addr.arpa" {
    type master;
    allow-transfer { key "zonetransfer.key"; };
    file "/etc/bind/named.dns.lab.rev";
};

// lab's ddns zone
zone "ddns.lab" {
    type master;
    allow-transfer { key "zonetransfer.key"; };
    allow-update { key "zonetransfer.key"; };
    file "/etc/bind/named.ddns.lab";
};